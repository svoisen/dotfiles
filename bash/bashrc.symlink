#!/bin/bash
#
# Sean Voisen <http://sean.voisen.org>

# -------------------------------------------------------------
# Basics
# -------------------------------------------------------------

# custom path
if [ -f ~/.bash_path ]; then
  . ~/.bash_path
fi

# if not running interactively, don't do anything else
[ -z "$PS1" ] && return

# vi editing mode
set -o vi

: ${HOME=~}
: ${LOGNAME=$(id -un)}
: ${UNAME=$(uname)}

# autocomplete known hosts
: ${HOSTFILE=~/.ssh/known_hosts}

# default umask
umask 0022

# -------------------------------------------------------------
# External Includes
# -------------------------------------------------------------

# custom aliases
if [ -f ~/.bash_aliases ]; then
  . ~/.bash_aliases
fi

# programmatic completion
if [ -f /etc/bash_completion ] && ! shopt -oq posix; then
    . /etc/bash_completion
fi

# -------------------------------------------------------------
# Environment
# -------------------------------------------------------------

# history settings
HISTCONTROL=$HISTCONTROL${HISTCONTROL+:}ignoredups
HISTCONTROL=ignoreboth
HISTFILESIZE=10000
HISTSIZE=10000

# shell options. see bash(1) for details
shopt -s histappend
shopt -s checkwinsize

# -------------------------------------------------------------
# Prompt
# -------------------------------------------------------------

RED="\[\033[0;31m\]"
BROWN="\[\033[0;33m\]"
GREY="\[\033[0;97m\]"
BLUE="\[\033[0;34m\]"
PS_CLEAR="\[\033[0m\]"
SCREEN_ESC="\[\033k\033\134\]"

if [ "$LOGNAME" = "root" ]; then
  COLOR1="${RED}"
  COLOR2="${BROWN}"
  P="#"
else
  COLOR1="${BLUE}"
  COLOR2="${BROWN}"
  P="\$"
fi

prompt_bw() {
  PS1="${SCREEN_ESC}\w${P} "
  PS2="> "
}

prompt_color() {
  PS1="${SCREEN_ESC}${COLOR2}\w ${COLOR1}${P}${PS_CLEAR} "
  PS2="${COLOR1}>${PS_CLEAR} "
}

prompt_color

# -------------------------------------------------------------
# Pager and Editor
# -------------------------------------------------------------

HAVE_VIM=$(command -v vim)
HAVE_GVIM=$(command -v gvim)

test -n "$HAVE_VIM" &&
  EDITOR=vim ||
  EDITOR=vi
export EDITOR

if test -n "$(command -v less)" ; then
  PAGER="less -FirSwX"
  MANPAGER="less -FirSwX"
else
  PAGER=more
  MANPAGER=more
fi
export PAGER MANPAGER

# -------------------------------------------------------------
# ls and Colors
# ------------------------------------------------------------- 

dircolors="$(type -P gdircolors dircolors | head -1)"
test -n "$dircolors" && {
  test -e "/etc/DIR_COLORS" && COLORS="/etc/DIR_COLORS"
  test -e "$HOME/.dircolors" && COLORS="$HOME/.dircolors"
  test ! -e "$COLORS"
  eval `$dircolors --sh $COLORS`
}
unset dircolors

if [ "$(uname -s)" == "Darwin" ] ; then
  alias ls='ls -hBG'
else
  alias ls='ls --color=auto'
  alias grep='grep --color=auto'
  alias fgrep='fgrep --color=auto'
  alias egrep='egrep --color=auto'
fi

# -------------------------------------------------------------
# git
# -------------------------------------------------------------

if [ -f ~/bin/git-completion.sh ] ; then
  source ~/bin/git-completion.sh
fi

# -------------------------------------------------------------
# java
# -------------------------------------------------------------

if [ "$(uname -s)" == "Darwin" ]
then
  JAVA_HOME_17=/Library/Java/JavaVirtualMachines/jdk1.7.0_65.jdk/Contents/Home
  export JAVA_HOME=$JAVA_HOME_17
fi
